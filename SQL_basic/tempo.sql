
CREATE DATABASE tempo;
USE tempo;

-----------------------------------------------------------------------------------------------
------------------------------------- CRIAÇÃO DAS TABELAS -------------------------------------
-----------------------------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS tempo (
	horario DATETIME NOT NULL PRIMARY KEY,
  	temperatura FLOAT NOT NULL,
  	vento FLOAT NOT NULL,
  	umidade FLOAT NOT NULL,
  	sensacao FLOAT NOT NULL
);

------------------------------------------------------------------------------------------------
--------------------------------------- INSERIR OS DADOS ---------------------------------------
------------------------------------------------------------------------------------------------

-- Download do arquivo csv que contem os dados: https://www.ic.unicamp.br/~zanoni/cepagri/cepagri.csv
INSERT INTO tempo (horario,temperatura,vento,umidade,sensacao) VALUES
("2022-09-01 00:00:00",13.4,20.4,77.9,11.2),
("2022-09-01 03:00:00",11.7,13.6,78.1,9.2),
("2022-09-01 06:00:00",10.6,7.6,78.1,7.7),
("2022-09-01 08:00:00",14.7,6.1,67.3,12.7),
("2022-09-01 11:00:00",23.4,7.3,41.1,22.2),
("2022-09-01 14:00:00",26.5,8.1,32.9,26.3),
("2022-09-01 17:00:00",27.0,6.4,29.0,25.7),
("2022-09-01 18:00:00",24.9,5.1,30.5,23.7),
("2022-09-01 21:00:00",18.9,7.9,40.3,17.5),
("2022-09-02 00:00:00",16.6,8.9,50.0,15.9),
("2022-09-02 03:00:00",14.5,0.2,50.2,12.4),
("2022-09-02 06:00:00",12.8,9.6,50.2,10.4),
("2022-09-02 08:00:00",16.4,5.4,55.1,14.6),
("2022-09-02 11:00:00",24.9,12.2,35.7,23.8),
("2022-09-02 14:00:00",29.9,12.0,27.4,29.4),
("2022-09-02 17:00:00",29.4,6.9,25.5,27.9),
("2022-09-02 18:00:00",27.5,1.7,28.4,26.2),
("2022-09-02 21:00:00",23.1,6.9,36.5,21.9),
("2022-09-03 00:00:00",19.6,22.8,53.2,18.3),
("2022-09-03 03:00:00",18.4,19.7,53.8,16.9),
("2022-09-03 06:00:00",16.0,6.9,53.8,14.2),
("2022-09-03 08:00:00",18.6,10.2,61.0,17.1),
("2022-09-03 11:00:00",25.1,9.3,41.8,23.9),
("2022-09-03 14:00:00",29.3,13.3,31.6,27.8),
("2022-09-03 17:00:00",26.3,23.3,47.4,25.1),
("2022-09-03 18:00:00",21.8,30.1,62.9,20.6),
("2022-09-03 21:00:00",16.9,22.1,74.4,15.3),
("2022-09-04 00:00:00",16.1,27.9,71.9,14.4),
("2022-09-04 03:00:00",13.7,26.6,72.5,11.6),
("2022-09-04 06:00:00",11.4,28.5,72.5,8.8),
("2022-09-04 08:00:00",12.2,27.6,80.9,9.8),
("2022-09-04 11:00:00",16.8,31.3,71.2,15.1),
("2022-09-04 14:00:00",19.1,33.6,61.8,17.7),
("2022-09-04 17:00:00",16.8,32.7,68.5,15.2),
("2022-09-04 18:00:00",15.4,29.8,72.8,13.5),
("2022-09-04 21:00:00",13.7,30.5,77.6,11.6),
("2022-09-05 00:00:00",12.9,29.8,75.7,10.6),
("2022-09-05 03:00:00",12.7,24.4,76.1,10.4),
("2022-09-05 06:00:00",12.9,22.7,76.1,10.5),
("2022-09-05 08:00:00",14.4,26.9,75.6,12.3),
("2022-09-05 11:00:00",21.4,10.9,60.0,20.2),
("2022-09-05 14:00:00",25.8,4.9,49.3,24.6),
("2022-09-05 17:00:00",21.6,26.0,59.9,20.4),
("2022-09-05 18:00:00",18.6,25.5,70.0,17.2),
("2022-09-05 21:00:00",16.3,23.7,77.4,14.6),
("2022-09-06 00:00:00",15.5,21.9,79.8,13.8),
("2022-09-06 03:00:00",14.9,20.1,79.8,13.1),
("2022-09-06 06:00:00",15.4,21.6,79.8,13.6),
("2022-09-06 08:00:00",16.8,23.1,78.1,15.2),
("2022-09-06 11:00:00",23.9,15.9,57.8,22.7),
("2022-09-06 14:00:00",24.8,11.4,53.3,23.7),
("2022-09-06 17:00:00",23.7,9.1,60.4,22.6),
("2022-09-06 18:00:00",20.9,21.9,68.4,19.7),
("2022-09-06 21:00:00",17.6,24.5,78.2,16.1),
("2022-09-07 00:00:00",16.4,10.0,84.5,14.8),
("2022-09-07 03:00:00",16.7,9.5,84.5,15.2),
("2022-09-07 06:00:00",17.4,8.5,84.5,15.9),
("2022-09-07 08:00:00",15.2,1.9,84.4,13.3),
("2022-09-07 11:00:00",15.5,13.7,87.9,13.8),
("2022-09-07 14:00:00",20.2,9.2,71.1,19.0),
("2022-09-07 17:00:00",20.1,10.8,77.1,18.9),
("2022-09-07 18:00:00",19.2,7.1,79.6,17.8),
("2022-09-07 21:00:00",17.8,10.7,80.4,16.4),
("2022-09-08 00:00:00",17.3,0.5,76.7,15.8),
("2022-09-08 03:00:00",16.7,3.3,75.5,15.1),
("2022-09-08 06:00:00",15.2,6.2,75.5,13.4),
("2022-09-08 08:00:00",19.0,3.8,65.5,17.6),
("2022-09-08 11:00:00",25.5,10.6,48.7,24.3),
("2022-09-08 14:00:00",29.4,8.7,39.3,28.0),
("2022-09-08 18:00:00",28.9,1.7,37.7,27.5),
("2022-09-08 19:00:00",26.9,0.0,41.3,25.70),
("2022-09-08 22:00:00",23.7,10.7,53.3,22.5),
("2022-09-09 03:00:00",20.1,3.5,59.4,18.8),
("2022-09-09 06:00:00",19.7,6.7,59.4,18.4),
("2022-09-09 08:00:00",21.3,7.2,66.0,20.1),
("2022-09-09 11:00:00",30.7,15.5,34.5,29.0),
("2022-09-09 14:00:00",33.0,16.6,30.4,31.0),
("2022-09-09 17:00:00",32.4,5.0,29.0,30.5),
("2022-09-09 18:00:00",30.7,0.9,32.9,29.1),
("2022-09-09 21:00:00",27.0,4.7,39.3,25.8),
("2022-09-10 00:00:00",23.0,7.9,53.5,21.9),
("2022-09-10 03:00:00",19.9,8.2,56.9,18.5),
("2022-09-10 06:00:00",19.3,6.8,56.9,18.0),
("2022-09-10 08:00:00",22.6,6.2,55.4,21.4),
("2022-09-10 11:00:00",29.9,12.2,37.4,28.4),
("2022-09-10 14:00:00",33.6,17.9,26.4,31.5),
("2022-09-10 17:00:00",32.5,15.6,27.6,30.5),
("2022-09-10 18:00:00",31.2,15.5,29.0,29.54),
("2022-09-10 21:00:00",20.0,31.8,73.3,18.7),
("2022-09-11 00:00:00",17.6,26.2,78.1,16.2),
("2022-09-11 04:00:00",15.3,20.2,78.5,13.5),
("2022-09-11 08:00:00",15.8,21.4,78.1,14.1),
("2022-09-11 09:00:00",17.3,18.6,74.5,15.7),
("2022-09-11 12:00:00",22.5,16.4,58.8,21.3),
("2022-09-11 15:00:00",25.9,12.1,50.4,24.8),
("2022-09-11 18:00:00",19.7,21.6,66.0,18.4),
("2022-09-11 19:00:00",18.0,27.5,71.3,16.6),
("2022-09-11 22:00:00",15.6,29.7,78.2,13.8),
("2022-09-12 03:00:00",14.5,19.1,79.7,12.5),
("2022-09-12 06:00:00",14.5,13.3,79.7,12.5),
("2022-09-12 08:00:00",16.8,9.5,79.3,15.2),
("2022-09-12 12:00:00",25.8,3.9,56.1,24.6);

------------------------------------------------------------------------------------------------
------------------------------------ APRESENTAÇÃO DOS DADOS ------------------------------------
------------------------------------------------------------------------------------------------

-- lista 10 registros mais atuais do tempo
SELECT horario, temperatura, vento, umidade, sensacao 
FROM tempo
ORDER BY horario DESC
LIMIT 10;

-- lista 10 registros mais atuais do tempo com os camposempo formatado
SELECT 
	DATE_FORMAT(horario, "%d/%m/%Y %h:%i %p (%a)") AS horario,
    CONCAT(temperatura, "°C") AS temperatura, 
    concat(ROUND(vento), " km/h")AS vento,
    CONCAT(umidade, "%") as umidade, 
    CONCAT(sensacao, "°C") AS sensacao 
FROM tempo
ORDER BY horario DESC
LIMIT 10;

-- apresenta o dia e o horario mais quente registrado
SELECT 
	DATE_FORMAT(horario, "%d/%m/%Y %h:%i %p (%a)") AS horario,
    CONCAT(temperatura, "°C") AS temperatura, 
    concat(ROUND(vento), " km/h")AS vento,
    CONCAT(umidade, "%") as umidade, 
    CONCAT(sensacao, "°C") AS sensacao 
FROM tempo
WHERE temperatura = (SELECT MAX(temperatura) FROM tempo)
ORDER BY horario DESC
LIMIT 1;

-- apresenta o dia e o horario mais frio registrado
SELECT 
	DATE_FORMAT(horario, "%d/%m/%Y %h:%i %p (%a)") AS horario,
    CONCAT(temperatura, "°C") AS temperatura, 
    concat(ROUND(vento), " km/h")AS vento,
    CONCAT(umidade, "%") as umidade, 
    CONCAT(sensacao, "°C") AS sensacao 
FROM tempo
WHERE temperatura = (SELECT MIN(temperatura) FROM tempo)
ORDER BY horario DESC
LIMIT 1;